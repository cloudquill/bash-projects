# System Monitoring Script with Email Alerts
The System Monitoring Script with Email Alerts is a robust tool 
designed to monitor critical system metrics and promptly notify you 
via email when specific thresholds are surpassed. This script provides 
real-time monitoring of CPU usage and memory consumption on your 
Linux system.
By promptly alerting you to potential issues or performance 
bottlenecks, it empowers you to take proactive measures and mitigate 
problems effectively.

Key Features:
-	Real-time monitoring of CPU usage and memory consumption.
-	Configurable threshold values to suit your requirements.
-	Email alerts triggered when thresholds are exceeded.

## Table of Contents:
1.	[Installation](#installation)
2.	[Configuring the SMTP Server](#configuring-the-smtp-server)
3.	[Usage](#usage)
4.	[Troubleshooting](#troubleshooting)
5.	[Conclusion](#troubleshooting)

## Installation
To begin using the System Monitoring Script with Email Alerts, follow 
these simple steps:
1.	Prerequisites:
-	A Gmail account.
-	Ensure you have administrative access to the Linux system.
-	Install the `ssmtp` package on your Linux system using your package
  manager (e.g., `apt` or `yum`). For example, on Kali, run:
     ```
     sudo apt install ssmtp
     ```

2.	Download and Extract:
-	Click on the "Code" button and download the ZIP file for the script.
-	Extract the contents of the ZIP file to your desired location.

3.	Configuration:
-	Navigate to the project directory.
-	Open the `system_monitoring.sh` file and update the required
  settings, such as recipient email address and threshold values.

By following these steps, you tailor the monitoring script to your 
requirements. But before you run it, you need to configure a SMTP 
server that will enable your system to send emails.

## Configuring the SMTP server
To configure the SMTP server for our script using Gmail, follow these 
steps:
1.	Get a Google App Password:
-	Go to [Sign in with app passwords - Google Account Help](https://support.google.com/accounts/answer/185833?visit_id=638328760287583675-3974505755&p=InvalidSecondFactor&rd=1)
  to generate an App password associated with your account. This
 	password will be used to authenticate the script with the Gmail
 	SMTP server.

2.	Configure your system's ssmtp.conf file:
-	The ssmtp.conf file was created when you installed the ssmtp utility.
  This contains the configuration information the utility uses to
 	access a SMTP server. It is typically in the /etc/ssmtp directory.
 	However, if it isnâ€™t there, you can search for it using the following
 	command:
     ```
     sudo find / -type f -name ssmtp.conf 2> /dev/null
     ```
  **Note**: Use sudo to ensure the command has sufficient permission to find the file.
- Open the ssmtp.conf file in the system-monitoring directory and copy
  its content.
- Edit your systemâ€™s ssmtp.conf file using a text editor, such as
  nano or vi. 
- Comment out the existing content in the file and paste the copied
  items at the bottom.
- Update the value of the AuthUser variable to your Gmail email
  address and the AuthPass variable to the Google App password you
  generated.

  **Note:** The App password generated by Google may include spaces. Do
  not include the spaces otherwise the authentication will fail.

3.	Save and Close the Configuration File:
- After making the necessary changes, save the `ssmtp.conf` file and
  close the text editor.

## Usage
To use the System Monitoring Script, follow the steps below:
1.	Manual Test:
- Start by running a manual test of the script to observe its
  performance.
- Change to the `system-monitoring` directory in your terminal.
- Execute the system monitoring script using the command:
     ```
     ./system_monitoring.sh
     	```
- If there are no errors outputted to the command line, check your
  inbox or the inbox of the recipient email address. You should
  receive an email with the monitoring results ðŸ˜Š

2.	Automating with Cron:
- Open the command line and run `crontab -e` to edit the crontab file.
- The file will contain several commented lines. Scroll to the bottom
  and enter the following line to run this script every 10mins:
     ```
     10 * * * * path/to/system_monitoring.sh
     ```
  Replace `path/to/system_monitoring.sh` with the actual path to the
  system monitoring script.
- Save the changes and exit the editor.
- The script will now run automatically every 10mins according to the
  configured cron schedule.
- Wait for the next execution in 10 minutes to observe the automated
  monitoring and email notifications.

## Troubleshooting
1.	Bad Credentials Error
- Review the ssmtp.conf file in a text editor.
- Verify that the email address and the App password you generated
  are correct.
- Ensure that there are no formatting issues in the configuration file.
- Make sure that the App password does not contain any spaces.
- Save the changes to the ssmtp.conf file and try running the script
  again.

2.	Not receiving Email when loaded in Cron
- Check if the script runs successfully when executed manually outside
  of cron. This will confirm that the script itself is functioning
  correctly.
- Create a copy of the system monitoring script or create a new script
  and include the following command in it to capture the current
  environment variables used by cron:
     ```
     env > ~/file.txt
     ```
- Load it on cron
- The command will save the environment variables to a file called
  file.txt in your home directory.
  ![image](https://github.com/cloudquill/bash-projects/assets/122037381/aa9090c5-64cb-4913-af27-1e5c96e6a4dc)

- Check the contents of file.txt to see the environment variables used
  by cron. Look for the PATH variable.
- Verify if the PATH variable includes the path to the ssmtp binary.
  If it is missing, this could be the cause of the issue.
  ![image](https://github.com/cloudquill/bash-projects/assets/122037381/b7204484-fda9-422b-9106-bfcca70a764e)

- Edit the send_mail.sh script and replace the ssmtp command with the 
full path to the ssmtp binary. In this case, it is _/usr/sbin/ssmtp_
- Save the changes to the script and try running it again using cron.
  The full path to ssmtp ensures that cron can locate and execute the
  command successfully.

## Conclusion
Thank you for checking out this script! I hope this helps you keep 
your system healthy and ensures timely notifications for critical 
events ðŸ˜Š
